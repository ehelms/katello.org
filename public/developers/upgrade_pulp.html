<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Upgrading Pulp</title>
    <meta name="viewport" content="width=device-width">

    <!-- syntax highlighting CSS -->
    <link rel="stylesheet" href="/assets/css/syntax.css">
    <link rel="stylesheet" href="/assets/css/font-awesome.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/assets/css/patternfly.css">
    <link rel="stylesheet" href="/assets/css/theme.css">
  </head>

  <body>
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="navbar-header">
    <a class="logo" href="/">
      <img src="/assets/images/default-logo.png" alt="Katello"/>
      <span>Katello</span>
    </a>
  </div>
  <div class="container">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" >Documentation<i class="caret"></i></a>
        <ul class="dropdown-menu">
          <li><a href="/docs">Nightly</a></li>
          <li><a href="/docs/2.0">2.0</a></li><li><a href="/docs/2.1">2.1</a></li>
        </ul>
      </li>
      <li>
        <a href="/developers">Developers</a>
      </li>
      <li>
        <a href="/community/index.html">Community</a>
      </li>
      <li>
        <a href="/troubleshooting/index.html">Troubleshooting</a>
      </li>
    </ul>
  </div>
</nav>


<div class="content">
  <h2 class="page-title">
    <div class="container">Upgrading Pulp</div>
  </h2>


  <section class="container has-sidebar">
    <nav class="context-nav">

  <ul>
    <li class="nav-item">
      <a href="#">Developer Guide</a>

      <ul class="sub-context-nav">
        
          
        
          
            
          
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
            
          
        
          
        
          
        
          
        
          
            
          
        
          
            
              <li class="nav-item">
                <a href="/developers/github_workflow.html">Github Workflow</a>
              </li>
            
          
        
          
        
          
            
              <li class="nav-item">
                <a href="/developers/hammer_dev_env.html">Hammer Dev Environment</a>
              </li>
            
          
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
            
          
        
          
        
          
        
          
        
          
            
          
        
          
        
          
            
          
        
          
            
              <li class="nav-item">
                <a href="/developers/pull_request_checklist.html">Pull Request Checklist</a>
              </li>
            
          
        
          
        
          
            
          
        
          
            
              <li class="nav-item">
                <a href="/developers/testing.html">Testing</a>
              </li>
            
          
        
          
            
              <li class="nav-item">
                <a href="/developers/upgrade_pulp.html">Upgrading Pulp</a>
              </li>
            
          
        
      </ul>
    </li>
  </ul>

  <ul>
  <li class="nav-item">
    <a href="#">Style Guides</a>

    <ul class="sub-context-nav">
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          <li class="nav-item">
            <a href="/developers/style/git_commit_messages.html">Style Guide: Commit Messages</a>
          </li>
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          <li class="nav-item">
            <a href="/developers/style/javascript.html">Style Guide: Javascript</a>
          </li>
        
      
        
      
        
      
        
          <li class="nav-item">
            <a href="/developers/style/ruby.html">Style Guide: Ruby</a>
          </li>
        
      
        
      
        
      
    </ul>

  </li>
</ul>

  <ul>
  <li class="nav-item">
    <a href="/docs/developer_guide/bastion">Bastion</a>

    <ul class="sub-context-nav">
      
        
      
        
          
            <li class="nav-item">
              <a href="/developers/bastion/add_custom_module.html">Bastion: Adding a Custom Module</a>
            </li>
          
        
      
        
          
            <li class="nav-item">
              <a href="/developers/bastion/add_entity.html">Bastion: Add Entity</a>
            </li>
          
        
      
        
      
        
      
        
      
        
      
        
      
        
          
            <li class="nav-item">
              <a href="/developers/bastion/dependencies.html">Bastion: Dependencies</a>
            </li>
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
            <li class="nav-item">
              <a href="/developers/bastion/i18n.html">Bastion: i18n</a>
            </li>
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    </ul>

  </li>
</ul>


</nav>



    <div class="section">
      
        <h1 id="upgrading-pulp">Upgrading Pulp</h1>

<p>This document describes how to upgrade to a new version of Pulp. <strong>Benchmarks are<br />
optional but highly recommended.</strong></p>

<h2 id="requirements">Requirements</h2>

<p>This assumes you have a working Katello installation and that you’ve checked<br />
out all the necessary repositories including Runcible (https://github.com/Katello/runcible).</p>

<ol>
  <li>
    <p>We recommend capturing some benchmarks before upgrading. This is<br />
optional though if the change in Pulp versions brings minor changes. See step 6<br />
for a idea of what to benchmark.</p>
  </li>
  <li>
    <p>Follow the Pulp documentation on how to install the latest version<br />
(https://pulp-user-guide.readthedocs.org/en/latest/installation.html). If<br />
upgrading from a prevous installation, typically a <code>yum update *pulp*</code> will<br />
suffice.  Once you have the latest version installed, make you sure you update<br />
or reset the database. (We recommend keeping track of all packages<br />
installed as part of this upgrade, as it will make package tagging easier in<br />
step 8.)</p>
  </li>
  <li>
    <p>Upgrade Runcible by running the VCR tests in live mode<br />
(https://github.com/Katello/runcible#testing). Fix any broken tests.<br />
Optionally, run some manual commands from a Ruby console to test Pulp’s<br />
functionality. Once you’re finished making changes, merge them into master<br />
(going through the Pull Request process).</p>
  </li>
  <li>
    <p>If Runcible changes were needed, release a new version of Runcible<br />
(https://github.com/Katello/runcible#building-and-releasing) but do NOT build<br />
new rpms in koji.</p>
  </li>
  <li>
    <p>Upgrade Katello to your new version of Runcible. Run the Katello VCR tests<br />
in live mode. Fix any failures.</p>
  </li>
  <li>Perform the following tests. If you took benchmarks in step 1, compare the<br />
times:
    <ul>
      <li>Create a yum repository with a URL and sync it.</li>
      <li>Create a puppet repository and upload some puppet modules for it.</li>
      <li>Enable a Red Hat repo (6server) and sync it.</li>
      <li>Create a content view with these repositories. Create a filter and publish the content view.</li>
      <li>Promote the content view to an environment other than Library. Confirm the content is on the filesystem and perform a content search.</li>
      <li>Register a consumer and perform some package action.</li>
      <li>Ensure that errata applicability generation works.</li>
    </ul>
  </li>
  <li>
    <p>Fix any failures from step 6.</p>
  </li>
  <li>Do the following within a short time frame:
    <ul>
      <li>Update Runcible requirement in katello.gemspec.</li>
      <li>Build new Runcible rpm.</li>
      <li>Merge open PR for new Runcible requirement and any Katello changes from the fixes from steps 4 &amp; 5.</li>
      <li>Tag into these Katello tags:
        <ul>
          <li>katello-thirdparty-pulp-rhel6</li>
          <li>katello-thirdparty-pulp-rhel7</li>
          <li>katello-thirdparty-pulp-fedoraXX<br />
 The following packages:</li>
          <li>pulp</li>
          <li>pulp-rpm</li>
          <li>pulp-puppet</li>
          <li>pulp-nodes</li>
          <li>gofer (if applicable)</li>
          <li>Occasionally other dependencies (such as<br />
https://github.com/pulp/pulp/tree/master/deps) are needed.  If you<br />
kept track of what was updated as part of your upgrade and you noticed<br />
any new deps pulled in from the Pulp repositories, tag those in now.</li>
        </ul>
      </li>
      <li>In order for the client repo to be populated properly, tag the new pulp-rpm package into the following tags:</li>
      <li>katello-nightly-rhel6</li>
      <li>katello-nightly-rhel7</li>
      <li>katello-nightly-fedoraXX</li>
      <li>
        <p>Sample tagging commands:</p>

        <div class="highlight"><pre><code>koji-katello tag-pkg  katello-thirdparty-pulp-rhel6   pulp-2.4.0-0.23.beta.el6 pulp-rpm-2.4.0-0.23.beta.el6  pulp-puppet-2.4.0-0.23.beta.el6 pulp-nodes-2.4.0-0.23.beta.el6  gofer-1.3.0-1.el6
koji-katello tag-pkg  katello-thirdparty-pulp-rhel7   pulp-2.4.0-0.23.beta.el7 pulp-rpm-2.4.0-0.23.beta.el7  pulp-puppet-2.4.0-0.23.beta.el7 pulp-nodes-2.4.0-0.23.beta.el7  gofer-1.3.0-1.el7
koji-katello tag-pkg  katello-thirdparty-pulp-fedora19   pulp-2.4.0-0.23.beta.fc19 pulp-rpm-2.4.0-0.23.beta.fc19  pulp-puppet-2.4.0-0.23.beta.fc19 pulp-nodes-2.4.0-0.23.beta.fc19  gofer-1.3.0-1.fc19
koji-katello tag-pkg katello-nightly-rhel6 pulp-rpm-2.4.0-0.23.beta.el6
koji-katello tag-pkg katello-nightly-rhel7 pulp-rpm-2.4.0-0.23.beta.el6
koji-katello tag-pkg katello-nightly-fedora19 pulp-rpm-2.4.0-0.23.beta.fc19
</code></pre></div>
      </li>
    </ul>
  </li>
  <li>
    <p>After 4 hours have passed and the new Pulp rpms have hit the Katello repos,<br />
perform a test install to ensure there are no issues.</p>
  </li>
  <li>Enjoy your new Pulp build and congratulate yourself for making it this far!</li>
</ol>

      
    </div>
  </section>

</div>


    <footer class="footer">
    <p>This web site is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_GB">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.  Source available: <a xmlns:dct="http://purl.org/dc/terms/" href="https://github.com/katello/katello.org" rel="dct:source">github.com/katello/katello.org</a>.</p>
</footer>


    <script src="/assets/js/jquery.min.js"></script>
    <script src="/assets/js/bootstrap.min.js"></script>
  </body>
</html>
